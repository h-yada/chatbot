{"filter":false,"title":"app.js","tooltip":"/app.js","undoManager":{"mark":0,"position":0,"stack":[[{"start":{"row":0,"column":0},"end":{"row":39,"column":0},"action":"remove","lines":["var port = process.env.PORT || 3000,","    http = require('http'),","    fs = require('fs'),","    html = fs.readFileSync('index.html');","","var log = function(entry) {","    fs.appendFileSync('/tmp/sample-app.log', new Date().toISOString() + ' - ' + entry + '\\n');","};","","var server = http.createServer(function (req, res) {","    if (req.method === 'POST') {","        var body = '';","","        req.on('data', function(chunk) {","            body += chunk;","        });","","        req.on('end', function() {","            if (req.url === '/') {","                log('Received message: ' + body);","            } else if (req.url = '/scheduled') {","                log('Received task ' + req.headers['x-aws-sqsd-taskname'] + ' scheduled at ' + req.headers['x-aws-sqsd-scheduled-at']);","            }","","            res.writeHead(200, 'OK', {'Content-Type': 'text/plain'});","            res.end();","        });","    } else {","        res.writeHead(200);","        res.write(html);","        res.end();","    }","});","","// Listen on port 3000, IP defaults to 127.0.0.1","server.listen(port);","","// Put a friendly message on the terminal","console.log('Server running at http://127.0.0.1:' + port + '/');",""],"id":2},{"start":{"row":0,"column":0},"end":{"row":59,"column":0},"action":"insert","lines":["","/**"," * Module dependencies."," */","","// Client","  // Server","  var log = console.log;","","var express = require('express');","","var app = module.exports = express.createServer();","","// Configuration","","app.configure(function(){","  app.set('views', __dirname + '/views');","  app.set('view engine', 'ejs');","  app.use(express.bodyParser());","  app.use(express.methodOverride());","  app.use(express.cookieParser());","  app.use(express.session({ secret: 'your secret here' }));","  app.use(app.router);","  app.use(express.static(__dirname + '/public'));","});","","app.configure('development', function(){","  app.use(express.errorHandler({ dumpExceptions: true, showStack: true })); ","});","","app.configure('production', function(){","  app.use(express.errorHandler()); ","});","","// Routes","","app.get('/', function(req, res){","  res.render('index', {","    title: 'Express'","  });","});","","app.listen(3000);","console.log(\"Express server listening on port %d in %s mode\", app.address().port, app.settings.env);","","var io = require('socket.io').listen(app);","","","io.sockets.on('connection', function (socket) { // 2","  log('connected');","  socket.on('msg send', function (msg) { // 4","    socket.emit('msg push', msg); // 5","    socket.broadcast.emit('msg push', msg); // 6","  });","  socket.on('disconnect', function() { // 9","    log('disconnected');","  });","});","",""]}]]},"ace":{"folds":[],"scrolltop":519,"scrollleft":0,"selection":{"start":{"row":59,"column":0},"end":{"row":59,"column":0},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":36,"state":"start","mode":"ace/mode/javascript"}},"timestamp":1564552547180,"hash":"dc915a44e8e379a69d81140d3774f0d710502b08"}